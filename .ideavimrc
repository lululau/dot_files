set idearefactormode=keep
set NERDTree
set surround
set argtextobj
set smartcase
set hlsearch
set incsearch
set ignorecase
set commentary
set exchange
" set easymotion
set vim-paragraph-motion
set textobj-entire
set highlightedyank
" 共享系统粘贴板
set clipboard=unnamed
" set expandtab
" set tabstop=4
" set shiftwidth=4
" set softtabstop=4
" set autoindent
" set cindent
" set encoding=utf-8
" set fileencoding=utf-8
" set fileencodings=utf-8,ucs-bom,chinese
" set formatoptions+=mM
" set ambiwidth=double
set noshowmode
set multiple-cursors
set textobj-indent
set ideajoin

let mapleader = " "

" System/Global
nnoremap s s<tab>
nnoremap <leader>qq :action Exit<cr>
nnoremap ,qq :action Exit<cr>
nnoremap <leader>qr :action RestartIde<cr>
nnoremap ,qr :action RestartIde<cr>
inoremap <c-a> <c-o>^
inoremap <c-e> <c-o>A
inoremap <c-f> <Right>
inoremap <c-b> <Left>
inoremap <c-n> <Down>
inoremap <c-p> <Up>
inoremap <c-d> <Del>
inoremap <c-i> <c-o>:action copilot.requestCompletions<cr>
nnoremap <c-c> i
inoremap <c-c> <esc>:action copilot.disposeInlays<cr>
nnoremap <c-a> ^
inoremap <c-k> <c-o>C
nnoremap <cr> :action EditorStartNewLine<cr>
noremap <leader>bk :action ToggleBookmarkWithMnemonic<cr>
noremap ,bk :action ToggleBookmarkWithMnemonic<cr>
noremap <D-a-b> :action ToggleLineBreakpoint<cr>
noremap <D-j> 10j
noremap <D-k> 10k
inoremap <D-j> <c-o>10j
inoremap <D-k> <c-o>10k
nnoremap Y y$
nnoremap <c-g> :call Clear_highlight_copilot()<cr>
inoremap <c-g> <c-o>:call Clear_highlight_copilot()<cr>
noremap <a-x> :action RunAnything<cr>
noremap mm :action ToggleBookmark<cr>
noremap m :action ToggleBookmark<cr>
noremap m0 :action ToggleBookmark0<cr>
noremap m1 :action ToggleBookmark1<cr>
noremap m2 :action ToggleBookmark2<cr>
noremap m3 :action ToggleBookmark3<cr>
noremap m4 :action ToggleBookmark4<cr>
noremap m5 :action ToggleBookmark5<cr>
noremap m6 :action ToggleBookmark6<cr>
noremap m7 :action ToggleBookmark7<cr>
noremap m8 :action ToggleBookmark8<cr>
noremap m9 :action ToggleBookmark9<cr>
noremap ma :action ToggleBookmarkA<cr>
noremap mb :action ToggleBookmarkB<cr>
noremap mc :action ToggleBookmarkC<cr>
noremap md :action ToggleBookmarkD<cr>
noremap me :action ToggleBookmarkE<cr>
noremap mf :action ToggleBookmarkF<cr>
noremap mg :action ToggleBookmarkG<cr>
noremap mh :action ToggleBookmarkH<cr>
noremap mi :action ToggleBookmarkI<cr>
noremap mj :action ToggleBookmarkJ<cr>
noremap mk :action ToggleBookmarkWithMnemonic<cr>
noremap ml :action ToggleBookmarkL<cr>
noremap mn :action ToggleBookmarkN<cr>
noremap mo :action ToggleBookmarkO<cr>
noremap mp :action ToggleBookmarkP<cr>
noremap mq :action ToggleBookmarkQ<cr>
noremap mr :action ToggleBookmarkR<cr>
noremap ms :action ToggleBookmarkS<cr>
noremap mt :action ToggleBookmarkT<cr>
noremap mu :action ToggleBookmarkU<cr>
noremap mv :action ToggleBookmarkV<cr>
noremap mw :action ToggleBookmarkW<cr>
noremap mx :action ToggleBookmarkX<cr>
noremap my :action ToggleBookmarkY<cr>
noremap mz :action ToggleBookmarkZ<cr>

nnoremap [[ :action MethodUp<cr>
nnoremap ]] :action MethodDown<cr>
nnoremap [c :action VcsShowPrevChangeMarker<cr>
nnoremap ]c :action VcsShowNextChangeMarker<cr>
noremap [e :action GotoPreviousError<cr>
noremap ]e :action GotoNextError<cr>
nnoremap ]f :action Tool_Files_OpenNextFile<cr>
nnoremap [f :action Tool_Files_OpenPreviousFile<cr>
nnoremap cio l[bc]w
nnoremap dio l[bd]w
nnoremap vio l[bv]w

noremap <leader>ep :action GotoPreviousError<cr>
noremap <leader>en :action GotoNextError<cr>

noremap ,ep :action GotoPreviousError<cr>
noremap ,en :action GotoNextError<cr>

" debugging
noremap <a-s> :action StepOver<cr>
noremap <a-S> :action ForceStepOver<cr>
nnoremap <a-f> :action StepOut<cr>
noremap <a-i> :action StepInto<cr>
noremap <D-i> :action StepInto<cr>
noremap <a-I> :action ForceStepInto<cr>
noremap <D-S> :action SmartStepInto<cr>
noremap <a-H> :action ForceRunToCursor<cr>
noremap <a-c> :action Resume<cr>
noremap <a-e> :action EvaluateExpression<cr>
noremap <D-e> ^v$:action EvaluateExpression<cr>

inoremap <a-s> :action StepOver<cr>
inoremap <a-S> :action ForceStepOver<cr>
inoremap <a-i> :action StepInto<cr>
inoremap <D-i> :action StepInto<cr>
inoremap <a-I> :action ForceStepInto<cr>
inoremap <D-S> :action SmartStepInto<cr>
inoremap <a-H> :action ForceRunToCursor<cr>
inoremap <a-c> :action Resume<cr>
inoremap <a-e> :action EvaluateExpression<cr>
inoremap <D-e> ^v$:action EvaluateExpression<cr>

" Motion/Jump
nnoremap <leader><Space> :action AceWordAction<cr>
nnoremap ,, :action AceWordAction<cr>
nmap <C-o> <Action>(Back)
nmap <C-i> <Action>(Forward)

" Getting Help
noremap <leader>hd :action QuickJavaDoc<cr>
noremap <leader>hs :action QuickImplementations<cr>
noremap <leader>dd :action SmartSearchAction<cr>
noremap <leader>dD :action SearchAction<cr>
noremap ,hd :action QuickJavaDoc<cr>
noremap ,hs :action QuickImplementations<cr>
noremap ,dd :action SmartSearchAction<cr>
noremap ,dD :action SearchAction<cr>

nnoremap <leader>tg    :action EditorToggleShowGutterIcons<CR>
vnoremap <leader>tg    :action EditorToggleShowGutterIcons<CR>

" Projects
nnoremap <leader>p, :action WelcomeScreen.Configure.ProjectStructure<cr>
nnoremap <leader>pt :action ActivateProjectToolWindow<cr>
nnoremap <leader>ps :action ShowProjectStructureSettings<cr>
nnoremap ,pt :action ActivateProjectToolWindow<cr>
nnoremap ,ps :action ShowProjectStructureSettings<cr>
nnoremap <leader>qf    :action CloseProject<CR>
vnoremap <leader>qf    <Esc>:action CloseProject<CR>

" Files
nnoremap <leader>fyy    :action CopyAbsolutePath<CR>
noremap <leader>feR :source ~/.ideavimrc<cr>
noremap <leader>fed :e ~/.ideavimrc<cr>
noremap <leader>feD :e ~/.ideavim_actions.txt<cr>
nnoremap <leader>fo :action Tool_Files_OpenWithEmacs<cr>
nnoremap <leader>fx :action Tool_Files_OpenWithVSCode<cr>
nnoremap <leader>fn :action Tool_Files_OpenWithNeovide<cr>
nnoremap <leader>fv :action Tool_Files_OpenWithNeovide<cr>
noremap <leader>fD :action Tool_Files_DeleteCurrentFile<cr>
noremap <leader>fy :action Tool_Files_CopyCurrentFilePath<cr>
noremap <leader>fY :action Tool_Files_CopyAndShowCurrentFilePath<cr>
noremap <leader>fa :action Tool_Files_BrowseInAlfred<cr>
noremap <leader>ad :action Tool_Files_ArthasClassReloadInDocker<cr>
noremap <leader>ak :action Tool_Files_ArthasClassReloadInK8s<cr>
noremap <leader>fR :action RefactoringMenuRenameFile<cr>
noremap <leader>fc :action CopyReference<cr>
noremap <leader>bs :e ~/Library/Application Support/JetBrains/IntelliJIdea2022.2/scratches/scratch.kts<cr>
noremap ,feR :source ~/.ideavimrc<cr>
noremap ,fed :e ~/.ideavimrc<cr>
noremap ,feD :e ~/.ideavim_actions.txt<cr>
nnoremap ,fo :action Tool_Files_OpenWithEmacs<cr>
noremap ,fD :action Tool_Files_DeleteCurrentFile<cr>
noremap ,fy :action Tool_Files_CopyCurrentFilePath<cr>
noremap ,fY :action Tool_Files_CopyAndShowCurrentFilePath<cr>
noremap ,fa :action Tool_Files_BrowseInAlfred<cr>
noremap ,fR :action RefactoringMenuRenameFile<cr>
noremap ,fc :action CopyReference<cr>
noremap ,ad :action Tool_Files_ArthasClassReloadInDocker<cr>
noremap ,ak :action Tool_Files_ArthasClassReloadInK8s<cr>
noremap <a-tab> :action TabSwitchPlugin.SwitchTab<cr>
noremap <leader>fnc :action NewClass<cr>
noremap <leader>fnf :action NewFile<cr>
noremap <leader>fb :action ShowBookmarks<cr>
noremap m, :action ShowBookmarks<cr>
noremap ,fnc :action NewClass<cr>
noremap ,fnf :action NewFile<cr>
noremap ,fb :action ShowBookmarks<cr>
noremap <D-s-n> :action NewClass<cr>
nnoremap <leader>jd :action Tool_Files_OpenPWDWithEmacs<cr>
nnoremap ,jd :action Tool_Files_OpenPWDWithEmacs<cr>
noremap ,bs :e ~/Library/Application Support/JetBrains/IntelliJIdea2021.2/scratches/scratch.kts<cr>

" Code
noremap <leader>cf :action ReformatCode<cr>
noremap <leader>cis :action ConvertIndentsToSpaces<cr>
noremap <leader>co :action OptimizeImports<cr>
noremap <leader>j= :action ReformatCode<cr>
noremap ,cf :action ReformatCode<cr>
noremap ,cis :action ConvertIndentsToSpaces<cr>
noremap ,co :action OptimizeImports<cr>
noremap ,ca :action Tool_Files_CodeArchiveSave<cr>
noremap ,j= :action ReformatCode<cr>

" Move lines down
nnoremap <leader>xJ    $:action MoveLineDown<CR>
vnoremap <leader>xJ    $:action MoveLineDown<CR>

" Move lines up
nnoremap <leader>xK    $:action MoveLineUp<CR>
vnoremap <leader>xK    $:action MoveLineUp<CR>

" Nav
noremap <leader>ni :action SelectInProjectView<cr>
noremap <leader>nI :action SelectIn<cr>
noremap <leader>ji :action FileStructurePopup<cr>
noremap <leader>jI :action GotoSymbol<cr>
noremap ,ni :action SelectInProjectView<cr>
noremap ,nI :action SelectIn<cr>
noremap ,ji :action FileStructurePopup<cr>
noremap ,jI :action GotoSymbol<cr>

" Search
nnoremap <leader>/ :action FindInPath<cr>
vnoremap <leader>/ <c-c>:action FindInPath<cr>
nnoremap <leader>* viw:action FindInPath<cr>
vnoremap <leader>* :action FindInPath<cr>
noremap <leader>su :action ShowUsages<cr>
noremap <leader>sU :action FindUsages<cr>
nnoremap <leader>sr :action ReplaceInPath<cr>
vnoremap <leader>sr <c-c>:action ReplaceInPath<cr>
nnoremap <leader>sR viw:action ReplaceInPath<cr>
vnoremap <leader>sR :action ReplaceInPath<cr>
nnoremap ,/ :action FindInPath<cr>
vnoremap ,/ <c-c>:action FindInPath<cr>
nnoremap ,* viw:action FindInPath<cr>
vnoremap ,* :action FindInPath<cr>
noremap ,su :action ShowUsages<cr>
noremap ,sU :action FindUsages<cr>
nnoremap ,sr :action ReplaceInPath<cr>
vnoremap ,sr <c-c>:action ReplaceInPath<cr>
nnoremap ,sR viw:action ReplaceInPath<cr>
vnoremap ,sR :action ReplaceInPath<cr>
nnoremap <leader>\ :action Toolkit.GotoService<cr>
vnoremap <leader>\ :action Toolkit.GotoService<cr>
nnoremap ,\ :action GoToRequestMapping<cr>
vnoremap ,\ :action GoToRequestMapping<cr>


" Toggles
noremap <leader>tp :action TogglePowerSave<cr>
noremap <leader>tN :action ViewNavigationBar<cr>
noremap <leader>tn :action EditorToggleShowLineNumbers<cr>
noremap <leader>tl :action EditorToggleUseSoftWraps<cr>
noremap <leader>tw :action EditorToggleShowWhitespaces<cr>
noremap <leader>tc :action EditorToggleColumnMode<cr>
noremap <leader>ti :action EditorToggleShowIndentLines<cr>
noremap <leader>tb :action EditorToggleShowBreadcrumbs<cr>
noremap <leader>tg :action EditorToggleShowGutterIcons<cr>
noremap <leader>ts :action ChangeInspectionProfile<cr>
noremap <leader>th :action ToggleInlineHintsAction<cr>
noremap <leader>Ct :call toggle_copilot()<cr>
noremap ,tp :action TogglePowerSave<cr>
noremap ,tN :action ViewNavigationBar<cr>
noremap ,tn :action EditorToggleShowLineNumbers<cr>
noremap ,tl :action EditorToggleUseSoftWraps<cr>
noremap ,tw :action EditorToggleShowWhitespaces<cr>
noremap ,tc :action EditorToggleColumnMode<cr>
noremap ,ti :action EditorToggleShowIndentLines<cr>
noremap ,tb :action EditorToggleShowBreadcrumbs<cr>
noremap ,tg :action EditorToggleShowGutterIcons<cr>
noremap ,ts :action ChangeInspectionProfile<cr>
noremap ,th :action ToggleInlineHintsAction<cr>
noremap ,Ct :call toggle_copilot()<cr>

" Maven/Gradle/Other Build-related Actions
noremap <leader>jx :action Tool_Run_Stop<cr>
noremap <leader>jX :action Tool_Run_Rerun<cr>
noremap <leader>rr :action Run<cr>
noremap <leader>rd :action Debug<cr>
noremap <leader>jr :action JRebel Executor<cr>
noremap <leader>bf :action Compile<cr>
noremap <leader>bm :action MakeModule<cr>
noremap <leader>bp :action CompileDirty<cr>
noremap <leader>bP :action CompileProject<cr>
noremap <leader>mi :action Maven.Reimport<cr>
noremap <leader>me :action Maven.ShowEffectivePom<cr>
noremap <leader>mP :action Tool_Files_OpenProjectPom<cr>
noremap <leader>mp :action Tool_Files_OpenModulePom<cr>
noremap ,jx :action Tool_Run_Stop<cr>
noremap ,jX :action Tool_Run_Rerun<cr>
noremap ,rr :action Run<cr>
noremap ,rd :action Debug<cr>
noremap ,jr :action JRebel Executor<cr>
noremap ,bf :action Compile<cr>
noremap ,bm :action MakeModule<cr>
noremap ,bp :action CompileDirty<cr>
noremap ,bP :action CompileProject<cr>
noremap ,mi :action Maven.Reimport<cr>
noremap ,me :action Maven.ShowEffectivePom<cr>
noremap ,mP :action Tool_Files_OpenProjectPom<cr>
noremap ,mp :action Tool_Files_OpenModulePom<cr>


" Show cpu usage
nnoremap <leader>aP    :action Performance.ActivityMonitor<CR>
vnoremap <leader>aP    :action Performance.ActivityMonitor<CR>

" List processes
nnoremap <leader>ap    :action ShowProcessWindow<CR>
vnoremap <leader>ap    :action ShowProcessWindow<CR>

nnoremap <leader>a,p    :action WelcomeScreen.Plugins<CR>
vnoremap <leader>a,p    :action WelcomeScreen.Plugins<CR>


" Tool Windows
noremap <leader>av :action ActivateBeanValidationToolWindow<cr>
noremap <leader>ac :action ActivateCheckStyleToolWindow<cr>
noremap <leader>aD :action ActivateDatabaseToolWindow<cr>
" noremap <leader>ad :action ActivateDebugToolWindow<cr>
noremap <leader>ae :action ActivateEventLogToolWindow<cr>
noremap <leader>aF :action ActivateFavoritesToolWindow<cr>
noremap <leader>af :action ActivateFindToolWindow<cr>
noremap <leader>aE :action ActivateJavaEnterpriseToolWindow<cr>
noremap <leader>ajc :action ActivateJRebelConsoleToolWindow<cr>
noremap <leader>aje :action ActivateJRebelExecutorToolWindow<cr>
noremap <leader>ajt :action ActivateJRebelToolWindow<cr>
noremap <leader>aM :action ActivateMavenProjectsToolWindow<cr>
noremap <leader>am :action ActivateMessagesToolWindow<cr>
noremap <leader>an :action ActivateNavBar<cr>

noremap <leader>ar :action ActivateRunToolWindow<cr>
noremap <leader>as :action ActivateSpringToolWindow<cr>
noremap <leader>aS :action ActivateStructureToolWindow<cr>
noremap <leader>' :action ActivateTerminalToolWindow<cr>
noremap <leader>at :action ActivateTODOToolWindow<cr>
noremap <leader>ag :action ActivateVersionControlToolWindow<cr>
noremap <leader>aw :action ActivateWebToolWindow<cr>
noremap <leader>aT :action ActiveToolwindowGroup<cr>
noremap <leader>ax :action HideSideWindows<cr>
noremap ,av :action ActivateBeanValidationToolWindow<cr>
noremap ,ac :action ActivateCheckStyleToolWindow<cr>
noremap ,aD :action ActivateDatabaseToolWindow<cr>
" noremap ,ad :action ActivateDebugToolWindow<cr>
noremap ,ae :action ActivateEventLogToolWindow<cr>
noremap ,aF :action ActivateFavoritesToolWindow<cr>
noremap ,af :action ActivateFindToolWindow<cr>
noremap ,aE :action ActivateJavaEnterpriseToolWindow<cr>
noremap ,ajc :action ActivateJRebelConsoleToolWindow<cr>
noremap ,aje :action ActivateJRebelExecutorToolWindow<cr>
noremap ,ajt :action ActivateJRebelToolWindow<cr>
noremap ,aM :action ActivateMavenProjectsToolWindow<cr>
noremap ,am :action ActivateMessagesToolWindow<cr>
noremap ,an :action ActivateNavBar<cr>
noremap ,ap :action ActivatePaletteToolWindow<cr>
noremap ,ar :action ActivateRunToolWindow<cr>
noremap ,as :action ActivateSpringToolWindow<cr>
noremap ,aS :action ActivateStructureToolWindow<cr>
noremap ,' :action ActivateTerminalToolWindow<cr>
noremap ,at :action ActivateTODOToolWindow<cr>
noremap ,ag :action ActivateVersionControlToolWindow<cr>
noremap ,aw :action ActivateWebToolWindow<cr>
noremap ,aT :action ActiveToolwindowGroup<cr>
noremap ,ax :action HideSideWindows<cr>


" Window Management
" nnoremap <A-h> :action VimWindowLeft<cr>
" nnoremap <A-j> :action VimWindowDown<cr>
" nnoremap <A-k> :action VimWindowUp<cr>
" nnoremap <A-l> :action VimWindowRight<cr>
" nnoremap <D-t> :action VimWindowSplitVertical<cr>
" nnoremap <D-S-t> :action VimWindowSplitHorizontal<cr>
" nnoremap <D-S-w> :action Unsplit<cr>

" Git
noremap <leader>gs :action Tool_Git_MagitStatus<cr>
noremap <leader>gd :action Tool_Git_DiffCurrentFile<cr>
noremap <leader>gb :action Tool_Git_BlameCurrentFile<cr>
noremap <leader>gu :action Tool_Git_RevertCurrentFile<cr>
noremap ,gs :action Tool_Git_MagitStatus<cr>
noremap ,gd :action Tool_Git_DiffCurrentFile<cr>
noremap ,gb :action Tool_Git_BlameCurrentFile<cr>
noremap ,gu :action Tool_Git_RevertCurrentFile<cr>

" RestfulTools
noremap <leader>fya :action RestfulTool.action.OptionForEditor-CopyApiPath<cr>
noremap <leader>fyA :action RestfulTool.action.OptionForEditor-CopyFullPath<cr>
noremap <leader>sy :action GenerateRestUrl<cr>
noremap <leader>sY :action GenerateFullRestUrl<cr>
noremap <leader>st :action RestfulTool.action.OptionForEditor-CurrentClassTree<cr>
noremap <leader>js :action RestfulTool.action.OptionForEditor-CurrentClassTree<cr>
noremap ,sy :action GenerateRestUrl<cr>
noremap ,sY :action GenerateFullRestUrl<cr>
noremap ,st :action RestfulTool.action.OptionForEditor-CurrentClassTree<cr>
noremap ,js :action RestfulTool.action.OptionForEditor-CurrentClassTree<cr>


" AliP3C Inspection
noremap <leader>ai :action AliP3CInspectionAction<cr>
noremap ,ai :action AliP3CInspectionAction<cr>


nnoremap <leader>bm    :action ActivateNotificationsToolWindow<CR>
vnoremap <leader>bm    :action ActivateNotificationsToolWindow<CR>

let g:copilot_on = 'true'

function! Clear_highlight_copilot()
  :noh
  :action copilot.disposeInlays
endfunction

function! toggle_copilot()
  if g:copilot_on == 'true'
    :action copilot.disableCopilot
    let g:copilot_on = 'false'
  else
    :action copilot.enableCopilot
    let g:copilot_on = 'true'
  endif
endfunction

sethandler <A-Tab> a:vim
sethandler <C-2> a:vim
sethandler <C-S-6> a:vim
sethandler <C-A> a:vim
sethandler <C-B> a:vim
sethandler <C-C> a:vim
sethandler <A-C> a:vim
sethandler <C-D> a:vim
sethandler <M-E> a:vim
sethandler <A-E> a:vim
sethandler <C-F> a:vim
sethandler <A-F> a:vim
sethandler <C-G> a:vim
sethandler <C-H> a:vim
sethandler <A-H> a:ide
sethandler <C-I> a:vim
sethandler <M-I> a:vim
sethandler <A-I> a:vim
sethandler <C-J> a:vim
sethandler <C-K> a:vim
sethandler <C-L> a:vim
sethandler <C-M> a:vim
sethandler <C-N> a:vim
sethandler <C-O> a:vim
sethandler <C-P> a:vim
sethandler <A-P> a:vim
sethandler <C-Q> a:ide
sethandler <C-R> a:vim
sethandler <C-S> a:vim
sethandler <M-S> a:vim
sethandler <A-S> a:vim
sethandler <C-T> a:vim
sethandler <C-U> a:vim
sethandler <C-V> a:vim
sethandler <C-W> a:vim
sethandler <C-X> a:ide
sethandler <C-Y> a:vim
sethandler <C-[> a:vim
sethandler <C-\> a:vim
sethandler <C-]> a:vim
